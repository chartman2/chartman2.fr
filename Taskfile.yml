version: '3'

tasks:
  build:
    desc: Construction des services Docker
    cmds:
      - UID_GID="$(id -u):$(id -g)" docker compose -f docker-compose.dev.yml build
  up:
    desc: Démarrage des services Docker
    cmds:
      - UID_GID="$(id -u):$(id -g)" docker compose -f docker-compose.dev.yml up -d
      - cat ~/.config/code-server/config.yaml
  down:
    desc: Arrêt des services Docker
    cmds:
      - docker compose -f docker-compose.dev.yml down
  logs:
    desc: Logs des services
    cmds:
      - docker compose -f docker-compose.dev.yml logs -f
  ps:
    desc: PS des services
    cmds:
      - docker compose -f docker-compose.dev.yml ps
  f-build:
    desc: Construction du services frontend Docker
    cmds:
      - UID_GID="$(id -u):$(id -g)" docker compose -f docker-compose.dev.yml build frontend-dev
  f-restart:
    desc: Redémarrage du service frontend-dev
    cmds:
      - docker compose -f docker-compose.dev.yml restart frontend-dev
  f-ssh:
    desc: Connexion SSH au frontend
    cmds:
      - docker compose exec frontend-dev sh
  prod-build:
    desc: Build du frontend de production
    cmds:
      - docker compose --env-file .env.production build
  prod-up:
    desc: Démarrage du frontend de production
    cmds:
      - docker compose --env-file .env.production up -d